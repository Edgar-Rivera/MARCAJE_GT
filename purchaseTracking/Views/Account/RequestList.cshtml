@model PagedList.IPagedList<purchaseTracking.Models.Activities.List>
@using PagedList.Mvc;

@{
    ViewBag.Title = "Mis Solicitudes Digitales";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    thead th {
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .table-responsive {
        height: auto;
        overflow: scroll;
    }

    .contenedor-principal {
        padding: 1.5rem;
        background-color: #ffffff;
    }

    .table thead {
        border-top-left-radius: 0.5rem;
        border-top-right-radius: 0.5rem;
        overflow: hidden;
        border: 1px solid #dee2e6;
        border-bottom: none;
        display: table-header-group;
        font-size:55px;
    }

        .table thead tr {
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }

        .table thead th {
            background-color: lightgray !important;
            color: #495057 !important;
            font-weight: 600;
            text-transform: uppercase;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #dee2e6;

            top: 0;
            z-index: 10;
            font-size: 0.8rem;
            border-right: 1px solid #dee2e6;
            border-left: 1px solid #dee2e6;
        }

        .table thead tr th:first-child {
            border-left: none;
        }

        .table thead tr th:last-child {
            border-right: none;
        }

    .clickable-row {
        cursor: pointer;
    }

        .clickable-row:hover {
            background-color: #f8f9fa !important;
        }

    .table tbody tr {
        border-bottom: 1px solid #e9ecef;
    }

        .table tbody tr td {
            background-color: #ffffff;
        }

        .table tbody tr:last-child {
            border-bottom: none !important;
        }

            .table tbody tr:last-child td {
                border-bottom: none !important;
                background-color: #ffffff !important;
            }

    .table-hover > tbody > tr:hover > * {
        background-color: #f8f9fa !important;
        color: #212529;
    }

    .table-wrap-75vh {
        height: 65vh !important;
        overflow-y: auto;
    }
    /*cambiar aqui los valores dependiendo del tamaño de la pantalla karen */
    .card-view {
        display: none;
    }

    .pagination a, .pagination span {
        color: #495057 !important;
        border: 1px solid #dee2e6 !important;
        background-color: #ffffff !important;
        box-shadow: none !important;
        padding: 0.375rem 0.75rem;
        margin-left: -1px;
        line-height: 1.5;
        position: relative;
        display: block;
    }

        .pagination a:hover, .pagination .page-item a:hover {
            background-color: #f8f9fa !important;
            color: #343a40 !important;
            border-color: #dee2e6 !important;
        }

    .pagination > .active > a, .pagination > .active > span {
        background-color: #4d4d54 !important;
        border-color: #4d4d54 !important;
        color: #ffffff !important;
        box-shadow: none !important;
        z-index: 3;
    }

    .pagination .page-item.disabled a {
        color: #6c757d !important;
        background-color: #e9ecef !important;
        border-color: #dee2e6 !important;
    }

    .pagination a:focus {
        box-shadow: none !important;
    }

    .busc {
        background-color: #198754;
        color: white;
        margin-left: 20PX;
        border-radius: 0;
    }

</style>
<div class="container-fluid">
    <div class="row justify-content-md-center">
        <div class="col-md-11 mt-3">
            <h4>Mis Solicitudes Creadas <span class="badge bg-secondary">@ViewBag.totalItem</span></h4>

            @using (Html.BeginForm("RequestList", "Account", FormMethod.Get))
            {
                <div class="form-row">
                    <div class="input-group mb-3">

                        <input type="text" class="form-control" placeholder="¿Qué deseas buscar?" name="findString" aria-describedby="basic-addon2">
                        <div class="input-group-append">
                            <input type="submit" class="btn btn-secondary" value="Buscar" />
                            <button type="submit" class="btn btn-primary" onclick="location.href='@Url.Action("RequestList", "Account")'"><i class="fas fa-redo"></i></button>
                        </div>
                    </div>
                </div>
                <div class="row g-2 align-items-end">
                    <div class="col-sm-2">
                        @Html.DropDownList("filterString", new List<SelectListItem>
                           {
                          new SelectListItem{ Text="Todos los datos", Value = "" },
                               new SelectListItem{ Text="Solicitud Vacaciones", Value = "Solicitud Vacaciones" },
                                new SelectListItem{ Text="Solicitud Permiso", Value = "Solicitud Permiso" }
                           }, new { @class = "form-control" })
                    </div>
                    <div class="col-sm-auto">
                        <button type="submit" class="btn btn-success" style="margin-left:1480px;"><i class="fas fa-filter"></i> Aplicar Filtro</button>
                    </div>
                </div>

            }

            @if (ViewBag.findString != null && Model.Count() > 0)
            {
                <div class="alert alert-success" role="alert">
                    @Model.TotalItemCount resultados para: <b> @ViewBag.findString</b>
                </div>
            }
            @if (Model.Count() > 0)
            {
                <div class="d-none d-lg-block table-wrap-75vh overflow-auto mt-3">
                    <table class="table table-hover align-middle table-fixed" style="text-align:center;">
                        <thead class="text-center table-dark">
                            <tr>
                                <th>
                                    No. Actividad
                                </th>
                                <th>
                                    Fecha de Solicitud
                                </th>
                                <th>
                                    Nombre de Solicitante
                                </th>

                                <th>
                                    Tipo Actividad
                                </th>
                                <th>
                                    Asunto de la Actividad
                                </th>
                                <th>
                                    Jefe Inmediato
                                </th>
                                <th>
                                    Estatus
                                </th>
                            </tr>
                        </thead>

                        @foreach (var item in Model)
                        {
                            <tr style="cursor:pointer !important" onclick="location.href = '@(Url.Action("detailsRequestAssign", "Account", new { id = item.ClgCode }))'">
                                <td>
                                    @item.ClgCode
                                </td>
                                <td>
                                    @item.Recontact
                                </td>
                                <td>
                                    @item.U_Solicitante
                                </td>
                                <td>
                                    @item.Name
                                </td>
                                <td>
                                    @item.Details
                                </td>
                                <td>

                                    @item.U_NAME
                                </td>
                                <td>
                                    @if (item.status == "-2")
                                    {
                                        <span class="badge bg-success d-block">En proceso</span>
                                    }
                                    else if (item.status == "1")
                                    {
                                        <span class="badge bg-success d-block">En proceso</span>
                                    }
                                    else if (item.status == "4")
                                    {
                                        <span class="badge bg-danger d-block">Rechazado</span>

                                    }
                                    else if (item.status == "-3")
                                    {
                                        <span class="badge bg-success d-block">Aprobado</span>

                                    }
                                </td>
                            </tr>
                        }
                    </table>
                </div>


                <div class="d-flex justify-content-end align-items-center mt-4">
                    <nav aria-label="Navegación" style="margin-top:50px;">
                        <ul class="pagination pagination-sm mb-0">
                            @Html.PagedListPager(Model, page => Url.Action("RequestList", new { page, findString = ViewBag.findString, filterString = ViewBag.filterString }),
                            new PagedListRenderOptions
                            {
                                LinkToFirstPageFormat = "«",
                                LinkToPreviousPageFormat = "‹ Anterior",
                                LinkToNextPageFormat = "Siguiente ›",
                                LinkToLastPageFormat = "»",
                                DisplayEllipsesWhenNotShowingAllPageNumbers = false,
                                LiElementClasses = new List<string> { "page-item" },
                                DisplayLinkToFirstPage = PagedListDisplayMode.Always,
                                DisplayLinkToLastPage = PagedListDisplayMode.Always,
                            })
                        </ul>
                    </nav>
                </div>
            }
            else
            {
                if (ViewBag.findString != null)
                {
                    <div class="alert alert-warning" role="alert">
                        No se encontraron resultados para <b>@ViewBag.findString</b>
                    </div>
                }
                else
                {
                    <div class="alert alert-info" role="alert">
                        Tu usuario actualmente no cuenta con solicitudes creadas
                    </div>
                }

            }

        </div>
    </div>
</div>

