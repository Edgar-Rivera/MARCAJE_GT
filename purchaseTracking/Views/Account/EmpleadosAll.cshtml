@model PagedList.IPagedList<purchaseTracking.Models.eTALENT.VACACIONES>

@using PagedList.Mvc;


@{
    ViewBag.Title = "Resumen de empleados";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    thead th {
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .contenedor-principal {
        padding: 1.5rem;
        background-color: #ffffff;
    }

    .table thead {
        border-top-left-radius: 0.5rem;
        border-top-right-radius: 0.5rem;
        overflow: hidden;
        border: 1px solid #dee2e6;
        border-bottom: none;
        display: table-header-group;
    }

        .table thead th {
            background-color: lightgray !important;
            color: #495057 !important;
            font-weight: 600;
            text-transform: uppercase;
            padding-top: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid #dee2e6;
            font-size: 0.8rem;
            border-right: 1px solid #dee2e6;
            border-left: 1px solid #dee2e6;
        }

    .table tbody tr {
        border-bottom: 1px solid #e9ecef;
    }

        .table tbody tr td {
            background-color: #ffffff;
        }

    .table-hover > tbody > tr:hover > * {
        background-color: #f8f9fa !important;
        color: #212529;
    }

    .table-wrap-75vh {
        height: 65vh !important;
        overflow-y: auto;
    }

    .table-responsive {
        overflow-x: auto;
    }

    .pagination a, .pagination span {
        color: #495057 !important;
        border: 1px solid #dee2e6 !important;
        background-color: #ffffff !important;
        box-shadow: none !important;
        padding: 0.375rem 0.75rem;
        margin-left: -1px;
        line-height: 1.5;
        display: block;
    }

    .pagination > .active > a,
    .pagination > .active > span {
        background-color: #4d4d54 !important;
        border-color: #4d4d54 !important;
        color: #ffffff !important;
    }

    @@media (max-width: 768px) {
        .table thead th,
        .table tbody td {
            font-size: 0.75rem;
            padding: 0.4rem;
        }

        h4 {
            font-size: 1.1rem;
        }
    }
</style>
<div class="container-fluid">
    <div class="row justify-content-md-center">
        <div class="col-md-11 mt-3">
            <h4>
                Resumen de Empleados
                <span class="badge bg-secondary">@ViewBag.totalItem</span>
            </h4>
       

            @using (Html.BeginForm("EmpleadosAll", "Account", FormMethod.Get))
            {

                <div class="row mb-3">
                    <form method="get">
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Buscar..." name="findString" aria-label="Buscar">
                            <button type="submit" class="btn btn-success">Buscar</button>
                            <a href="@Url.Action("EmpleadosAll", "Account")" class="btn btn-primary">
                                <i class="fas fa-redo"></i>
                            </a>
                        </div>
                    </form>
                </div>

                <div class="row g-2 align-items-end">

                    <!-- filtros izquierda -->
                    <div class="col-md-6 d-flex flex-wrap gap-2">
                        <div style="min-width:180px;">
                            @Html.DropDownList("filterEmpleado", new SelectList(ViewBag.Empleado), new { @class = "form-control chosen" })
                        </div>

                        <div style="min-width:180px;">
                            @Html.DropDownList("filterUnidad", new SelectList(ViewBag.Unidad), new { @class = "form-control chosen" })
                        </div>
                    </div>

                    <!-- botones derecha -->
                    <div class="col-md-6 text-md-end text-start mt-2 mt-md-0">

                        <button type="submit" class="btn btn-success me-2">
                            <i class="fas fa-filter"></i> Aplicar Filtro
                        </button>

                        <a href="@Url.Action("ExportarEmpleados")" class="btn btn-success me-2">
                            Exportar a Excel
                        </a>

                        <a href="@Url.Action("ExportarEmpleadosEstatus")" class="btn btn-success">
                            Exportar Estatus
                        </a>

                    </div>

                </div>


            }

            @if (Model.Count() > 0)
            {
              <div class="table-responsive table-wrap-75vh overflow-auto mt-3">
            <table class="table table-hover align-middle table-fixed" style="text-align:center; min-width:900px;">
                <thead class="text-center table-dark">
                    <tr>
                        <th>
                            Código de Empleado
                        </th>
                        <th>
                            Nombre Completo
                        </th>
                        <th>
                            Unidad
                        </th>
                        <th>
                            Fecha de Ingreso
                        </th>
                        <th>
                            Total Días Vacaciones
                        </th>
                        <th>
                            Dias Gozados
                        </th>
                        <th>
                            Días Disponibles
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        int temp_total = (int)Math.Round(item.DIAS);
                        int temp_gozados = (int)Math.Round(item.GOZADOS);
                        int temp_dias = (int)Math.Round(item.DIAS - item.GOZADOS);
                        <tr>
                            <td class="text-center" style="cursor:pointer !important" onclick="location.href = '@(Url.Action("detailsHours", "Account", new { Codigo = item.EPDO_CODIGO }))'">
                                @item.EPDO_CODIGO
                            </td>
                            <td>
                                @item.EPDO_NOMBRE_COMPLETO
                            </td>
                            <td>
                                @item.UND_NOMBRE
                            </td>
                            <td class="text-center">
                                @item.FECHA
                            </td>
                            <td class="text-center">
                                @temp_total
                            </td>
                            <td class="text-center">
                                @temp_gozados
                            </td>
                            <td class="text-center">
                                @temp_dias
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
              </div>

                <div class="d-flex justify-content-end align-items-center mt-4">
                    <nav aria-label="Navegación" style="margin-top:50px;">
                        <ul class="pagination pagination-sm mb-0">
                            @Html.PagedListPager(
                                Model,
                                page => Url.Action("EmpleadosAll",
                                new
                                {
                                    page,
                                    findString = ViewBag.findString
                                }),
                                new PagedListRenderOptions
                                {
                                    LinkToFirstPageFormat = "«",
                                    LinkToPreviousPageFormat = "‹ Anterior",
                                    LinkToNextPageFormat = "Siguiente ›",
                                    LinkToLastPageFormat = "»",
                                    DisplayEllipsesWhenNotShowingAllPageNumbers = false,
                                    LiElementClasses = new List<string> { "page-item" },
                                    DisplayLinkToFirstPage = PagedListDisplayMode.Always,
                                    DisplayLinkToLastPage = PagedListDisplayMode.Always,
                                })
                        </ul>
                    </nav>
                </div>
            }
            else
            {
                if (ViewBag.findString != null)
                {
                    <div class="alert alert-warning" role="alert">
                        No se encontraron resultados para <b>@ViewBag.findString</b>
                    </div>
                }
            }
        </div>

    </div>
</div>
